(function(a,b){typeof exports=='object'&&typeof module!='undefined'?module.exports=b():typeof define=='function'&&define.amd?define(b):(a=a||self,a.Fuse=b())})(this,function(){'use strict';var ac,I,H,Q,J,K,L,F,N,S,T,U,V,a,X,q,h,C,e,ak,al,am,an,ao,R,G,B,o,x,ab,aa,$,Y,n,m,s,t,ad,ae,y,l;function p(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?p=function(a){return typeof a}:p=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},p(a)}function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function ai(d,c){for(var b=0,a;b<c.length;b++)a=c[b],a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}function c(a,b,c){return b&&ai(a.prototype,b),c&&ai(a,c),a}function D(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function ah(a,d){var b=Object.keys(a),c;return Object.getOwnPropertySymbols&&(c=Object.getOwnPropertySymbols(a),d&&(c=c.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),b.push.apply(b,c)),b}function ag(c){for(var a=1,b;a<arguments.length;a++)b=arguments[a]!=null?arguments[a]:{},a%2?ah(Object(b),!0).forEach(function(a){D(c,a,b[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(b)):ah(Object(b)).forEach(function(a){Object.defineProperty(c,a,Object.getOwnPropertyDescriptor(b,a))});return c}function j(b,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),a&&z(b,a)}function r(a){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},r(a)}function z(a,b){return z=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},z(a,b)}function aK(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function ap(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function aJ(b,a){return a&&(typeof a=="object"||typeof a=="function")?a:ap(b)}function i(a){var b=aK();return function(){var d=r(a),c,e;return b?(e=r(this).constructor,c=Reflect.construct(d,arguments,e)):c=d.apply(this,arguments),aJ(this,c)}}function k(a){return aI(a)||aH(a)||aG(a)||aF()}function aI(a){if(Array.isArray(a))return w(a)}function aH(a){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(a))return Array.from(a)}function aG(a,c){if(!a)return;if(typeof a=="string")return w(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if(b==="Object"&&a.constructor&&(b=a.constructor.name),b==="Map"||b==="Set")return Array.from(a);if(b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return w(a,c)}function w(c,a){(a==null||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function aF(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(a){return Array.isArray?Array.isArray(a):M(a)==='[object Array]'}ac=1/0;function aE(a){if(typeof a=='string')return a;var b=a+'';return b=='0'&&1/a==-ac?'-0':b}function aD(a){return a==null?'':aE(a)}function f(a){return typeof a=='string'}function Z(a){return typeof a=='number'}function aC(a){return a===!0||a===!1||aB(a)&&M(a)=='[object Boolean]'}function W(a){return p(a)==='object'}function aB(a){return W(a)&&a!==null}function d(a){return a!==void 0&&a!==null}function E(a){return!a.trim().length}function M(a){return a==null?a===void 0?'[object Undefined]':'[object Null]':Object.prototype.toString.call(a)}I='Extended search is not available',H="Incorrect 'index' type",Q=function(a){return"Invalid value for key ".concat(a)},J=function(a){return"Pattern length exceeds max of ".concat(a,".")},K=function(a){return"Missing ".concat(a," property in key")},L=function(a){return"Property 'weight' in key '".concat(a,"' must be a positive integer")},F=Object.prototype.hasOwnProperty,N=function(){function a(e){var d=this,c;b(this,a),this._keys=[],this._keyMap={},c=0,e.forEach(function(b){var a=O(b);c+=a.weight,d._keys.push(a),d._keyMap[a.id]=a,c+=a.weight}),this._keys.forEach(function(a){a.weight/=c})}return c(a,[{key:"get",value:function(a){return this._keyMap[a]}},{key:"keys",value:function(){return this._keys}},{key:"toJSON",value:function(){return JSON.stringify(this._keys)}}]),a}();function O(a){var c=null,d=null,e=null,h=1,b;if(f(a)||g(a))e=a,c=P(a),d=v(a);else{if(!F.call(a,'name'))throw new Error(K('name'));if(b=a.name,e=b,F.call(a,'weight'))if(h=a.weight,h<=0)throw new Error(L(b));c=P(b),d=v(b)}return{path:c,id:d,weight:h,src:e}}function P(a){return g(a)?a:a.split('.')}function v(a){return g(a)?a.join('.'):a}function aA(e,b){var a=[],c=!1,h=function l(j,e,h){var k,b,i,m;if(!d(j))return;if(e[h]){if(k=e[h],b=j[k],!d(b))return;if(h===e.length-1&&(f(b)||Z(b)||aC(b)))a.push(aD(b));else if(g(b)){c=!0;for(i=0,m=b.length;i<m;i+=1)l(b[i],e,h+1)}else e.length&&l(b,e,h+1)}else a.push(j)};return h(e,f(b)?b.split('.'):b,0),c?a:a[0]}S={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},T={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function(a,b){return a.score===b.score?a.idx<b.idx?-1:1:a.score<b.score?-1:1}},U={location:0,threshold:.6,distance:100},V={useExtendedSearch:!1,getFn:aA,ignoreLocation:!1,ignoreFieldNorm:!1},a=ag({},T,{},S,{},U,{},V),X=/[^ ]+/g;function az(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,a=new Map;return{get:function(e){var c=e.match(X).length,d;return a.has(c)?a.get(c):(d=parseFloat((1/Math.sqrt(c)).toFixed(b)),a.set(c,d),d)},clear:function(){a.clear()}}}q=function(){function e(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=d.getFn,f=c===void 0?a.getFn:c;b(this,e),this.norm=az(3),this.getFn=f,this.isCreated=!1,this.setIndexRecords()}return c(e,[{key:"setSources",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.docs=a}},{key:"setIndexRecords",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.records=a}},{key:"setKeys",value:function(){var b=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.keys=a,this._keysMap={},a.forEach(function(a,c){b._keysMap[a.id]=c})}},{key:"create",value:function(){var a=this;if(this.isCreated||!this.docs.length)return;this.isCreated=!0,f(this.docs[0])?this.docs.forEach(function(b,c){a._addString(b,c)}):this.docs.forEach(function(b,c){a._addObject(b,c)}),this.norm.clear()}},{key:"add",value:function(a){var b=this.size();f(a)?this._addString(a,b):this._addObject(a,b)}},{key:"removeAt",value:function(b){this.records.splice(b,1);for(var a=b,c=this.size();a<c;a+=1)this.records[a].i-=1}},{key:"getValueForItemAtKeyId",value:function(a,b){return a[this._keysMap[b]]}},{key:"size",value:function(){return this.records.length}},{key:"_addString",value:function(a,b){if(!d(a)||E(a))return;var c={v:a,i:b,n:this.norm.get(a)};this.records.push(c)}},{key:"_addObject",value:function(c,e){var a=this,b={i:e,$:{}};this.keys.forEach(function(i,h){var e=a.getFn(c,i.path),j;if(!d(e))return;g(e)?function(){for(var j=[],i=[{nestedArrIndex:-1,value:e}],k,l,c,m;i.length;){if(k=i.pop(),l=k.nestedArrIndex,c=k.value,!d(c))continue;f(c)&&!E(c)?(m={v:c,i:l,n:a.norm.get(c)},j.push(m)):g(c)&&c.forEach(function(a,b){i.push({nestedArrIndex:b,value:a})})}b.$[h]=j}():E(e)||(j={v:e,n:a.norm.get(e)},b.$[h]=j)}),this.records.push(b)}},{key:"toJSON",value:function(){return{keys:this.keys,records:this.records}}}]),e}();function _(d,e){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c=f.getFn,g=c===void 0?a.getFn:c,b=new q({getFn:g});return b.setKeys(d.map(O)),b.setSources(e),b.create(),b}function ay(d){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=e.getFn,f=c===void 0?a.getFn:c,g=d.keys,h=d.records,b=new q({getFn:f});return b.setKeys(g),b.setIndexRecords(h),b}function aw(c,a){var b=c.matches;if(a.matches=[],!d(b))return;b.forEach(function(b){var e,f,c;if(!d(b.indices)||!b.indices.length)return;e=b.indices,f=b.value,c={indices:e,value:f},b.key&&(c.key=b.key.src),b.idx>-1&&(c.refIndex=b.idx),a.matches.push(c)})}function av(a,b){b.score=a.score}function u(o){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=b.errors,n=e===void 0?0:e,f=b.currentLocation,l=f===void 0?0:f,h=b.expectedLocation,k=h===void 0?0:h,j=b.distance,d=j===void 0?a.distance:j,g=b.ignoreLocation,m=g===void 0?a.ignoreLocation:g,c=n/o.length,i;return m?c:(i=Math.abs(k-l),!d)?i?1:c:c+i/d}function au(){for(var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a.minMatchCharLength,e=[],b=-1,f=-1,c=0,i=d.length,h;c<i;c+=1)h=d[c],h&&b===-1?b=c:!h&&b!==-1&&(f=c-1,f-b+1>=g&&e.push([b,f]),b=-1);return d[c-1]&&c-b>=g&&e.push([b,c-1]),e}h=32;function at(z,e,S){var g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},G=g.location,R=G===void 0?a.location:G,L=g.distance,r=L===void 0?a.distance:L,K=g.threshold,W=K===void 0?a.threshold:K,O=g.findAllMatches,T=O===void 0?a.findAllMatches:O,D=g.minMatchCharLength,E=D===void 0?a.minMatchCharLength:D,H=g.includeMatches,I=H===void 0?a.includeMatches:H,N=g.ignoreLocation,w=N===void 0?a.ignoreLocation:N,l,m,b,k,f,p,B,o,V,A,n,q,v,Q,i,s,d,P,C,y,j,c,t,F,U,x,M;if(e.length>h)throw new Error(J(h));for(l=e.length,m=z.length,b=Math.max(0,Math.min(R,m)),k=W,f=b,p=E>1||I,B=p?Array(m):[];(o=z.indexOf(e,f))>-1;)if(V=u(e,{currentLocation:o,expectedLocation:b,distance:r,ignoreLocation:w}),k=Math.min(V,k),f=o+l,p)for(A=0;A<l;)B[o+A]=1,A+=1;f=-1,n=[],q=1,v=l+m,Q=1<<l-1;for(i=0;i<l;i+=1){for(s=0,d=v;s<d;)P=u(e,{errors:i,currentLocation:b+d,expectedLocation:b,distance:r,ignoreLocation:w}),P<=k?s=d:v=d,d=Math.floor((v-s)/2+s);v=d,C=Math.max(1,b-d+1),y=T?m:Math.min(b+d,m)+l,j=Array(y+2),j[y+1]=(1<<i)-1;for(c=y;c>=C;c-=1)if(t=c-1,F=S[z.charAt(t)],p&&(B[t]=+!!F),j[c]=(j[c+1]<<1|1)&F,i&&(j[c]|=(n[c+1]|n[c])<<1|1|n[c+1]),j[c]&Q)if(q=u(e,{errors:i,currentLocation:t,expectedLocation:b,distance:r,ignoreLocation:w}),q<=k){if(k=q,f=t,f<=b)break;C=Math.max(1,2*b-f)}if(U=u(e,{errors:i+1,currentLocation:b,expectedLocation:b,distance:r,ignoreLocation:w}),U>k)break;n=j}return x={isMatch:f>=0,score:Math.max(.001,q)},p&&(M=au(B,E),M.length?I&&(x.indices=M):x.isMatch=!1),x}function ar(c){for(var b={},a=0,d=c.length,e;a<d;a+=1)e=c.charAt(a),b[e]=(b[e]||0)|1<<d-a-1;return b}C=function(){function d(q){var A=this,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k=c.location,z=k===void 0?a.location:k,j=c.threshold,y=j===void 0?a.threshold:j,l=c.distance,x=l===void 0?a.distance:l,n=c.includeMatches,v=n===void 0?a.includeMatches:n,p=c.findAllMatches,C=p===void 0?a.findAllMatches:p,r=c.minMatchCharLength,u=r===void 0?a.minMatchCharLength:r,i=c.isCaseSensitive,s=i===void 0?a.isCaseSensitive:i,o=c.ignoreLocation,w=o===void 0?a.ignoreLocation:o,g,f,e,m,B,t;if(b(this,d),this.options={location:z,threshold:y,distance:x,includeMatches:v,findAllMatches:C,minMatchCharLength:u,isCaseSensitive:s,ignoreLocation:w},this.pattern=s?q:q.toLowerCase(),this.chunks=[],!this.pattern.length)return;if(g=function(a,b){A.chunks.push({pattern:a,alphabet:ar(a),startIndex:b})},f=this.pattern.length,f>h){for(e=0,m=f%h,B=f-m;e<B;)g(this.pattern.substr(e,h),e),e+=h;m&&(t=f-h,g(this.pattern.substr(t),t))}else g(this.pattern,0)}return c(d,[{key:"searchIn",value:function(b){var f=this.options,q=f.isCaseSensitive,d=f.includeMatches,g,a,p,j,o,l,m,n,e,h,c,i;return q||(b=b.toLowerCase()),this.pattern===b?(g={isMatch:!0,score:0},d&&(g.indices=[[0,b.length-1]]),g):(a=this.options,p=a.location,j=a.distance,o=a.threshold,l=a.findAllMatches,m=a.minMatchCharLength,n=a.ignoreLocation,e=[],h=0,c=!1,this.chunks.forEach(function(a){var t=a.pattern,q=a.alphabet,r=a.startIndex,f=at(b,t,q,{location:p+r,distance:j,threshold:o,findAllMatches:l,minMatchCharLength:m,includeMatches:d,ignoreLocation:n}),i=f.isMatch,s=f.score,g=f.indices;i&&(c=!0),h+=s,i&&g&&(e=[].concat(k(e),k(g)))}),i={isMatch:c,score:c?h/this.chunks.length:1},c&&d&&(i.indices=e),i)}}]),d}(),e=function(){function a(c){b(this,a),this.pattern=c}return c(a,[{key:"search",value:function(){}}],[{key:"isMultiMatch",value:function(a){return aj(a,this.multiRegex)}},{key:"isSingleMatch",value:function(a){return aj(a,this.singleRegex)}}]),a}();function aj(b,c){var a=b.match(c);return a?a[1]:null}ak=function(d){j(a,d);var e=i(a);function a(c){return b(this,a),e.call(this,c)}return c(a,[{key:"search",value:function(b){var a=b===this.pattern;return{isMatch:a,score:a?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return'exact'}},{key:"multiRegex",get:function(){return/^="(.*)"$/}},{key:"singleRegex",get:function(){return/^=(.*)$/}}]),a}(e),al=function(d){j(a,d);var e=i(a);function a(c){return b(this,a),e.call(this,c)}return c(a,[{key:"search",value:function(a){var c=a.indexOf(this.pattern),b=c===-1;return{isMatch:b,score:b?0:1,indices:[0,a.length-1]}}}],[{key:"type",get:function(){return'inverse-exact'}},{key:"multiRegex",get:function(){return/^!"(.*)"$/}},{key:"singleRegex",get:function(){return/^!(.*)$/}}]),a}(e),am=function(d){j(a,d);var e=i(a);function a(c){return b(this,a),e.call(this,c)}return c(a,[{key:"search",value:function(b){var a=b.startsWith(this.pattern);return{isMatch:a,score:a?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return'prefix-exact'}},{key:"multiRegex",get:function(){return/^\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^\^(.*)$/}}]),a}(e),an=function(d){j(a,d);var e=i(a);function a(c){return b(this,a),e.call(this,c)}return c(a,[{key:"search",value:function(a){var b=!a.startsWith(this.pattern);return{isMatch:b,score:b?0:1,indices:[0,a.length-1]}}}],[{key:"type",get:function(){return'inverse-prefix-exact'}},{key:"multiRegex",get:function(){return/^!\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^!\^(.*)$/}}]),a}(e),ao=function(d){j(a,d);var e=i(a);function a(c){return b(this,a),e.call(this,c)}return c(a,[{key:"search",value:function(a){var b=a.endsWith(this.pattern);return{isMatch:b,score:b?0:1,indices:[a.length-this.pattern.length,a.length-1]}}}],[{key:"type",get:function(){return'suffix-exact'}},{key:"multiRegex",get:function(){return/^"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^(.*)\$$/}}]),a}(e),R=function(d){j(a,d);var e=i(a);function a(c){return b(this,a),e.call(this,c)}return c(a,[{key:"search",value:function(a){var b=!a.endsWith(this.pattern);return{isMatch:b,score:b?0:1,indices:[0,a.length-1]}}}],[{key:"type",get:function(){return'inverse-suffix-exact'}},{key:"multiRegex",get:function(){return/^!"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^!(.*)\$$/}}]),a}(e),G=function(e){j(d,e);var f=i(d);function d(o){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=c.location,v=h===void 0?a.location:h,j=c.threshold,t=j===void 0?a.threshold:j,l=c.distance,r=l===void 0?a.distance:l,n=c.includeMatches,p=n===void 0?a.includeMatches:n,g=c.findAllMatches,q=g===void 0?a.findAllMatches:g,m=c.minMatchCharLength,s=m===void 0?a.minMatchCharLength:m,k=c.isCaseSensitive,u=k===void 0?a.isCaseSensitive:k,i=c.ignoreLocation,w=i===void 0?a.ignoreLocation:i,e;return b(this,d),e=f.call(this,o),e._bitapSearch=new C(o,{location:v,threshold:t,distance:r,includeMatches:p,findAllMatches:q,minMatchCharLength:s,isCaseSensitive:u,ignoreLocation:w}),e}return c(d,[{key:"search",value:function(a){return this._bitapSearch.searchIn(a)}}],[{key:"type",get:function(){return'fuzzy'}},{key:"multiRegex",get:function(){return/^"(.*)"$/}},{key:"singleRegex",get:function(){return/^(.*)$/}}]),d}(e),B=function(d){j(a,d);var e=i(a);function a(c){return b(this,a),e.call(this,c)}return c(a,[{key:"search",value:function(e){for(var a=0,c=[],f=this.pattern.length,b,d;(b=e.indexOf(this.pattern,a))>-1;)a=b+f,c.push([b,a-1]);return d=!!c.length,{isMatch:d,score:d?1:0,indices:c}}}],[{key:"type",get:function(){return'include'}},{key:"multiRegex",get:function(){return/^'"(.*)"$/}},{key:"singleRegex",get:function(){return/^'(.*)$/}}]),a}(e),o=[ak,B,am,an,R,ao,al,G],x=o.length,ab=/ +(?=([^\"]*\"[^\"]*\")*[^\"]*$)/,aa='|';function ax(b){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return b.split(aa).map(function(l){for(var h=l.trim().split(ab).filter(function(a){return a&&!!a.trim()}),d=[],e=0,m=h.length,g,c,b,i,j,f,k;e<m;e+=1){for(g=h[e],c=!1,b=-1;!c&&++b<x;)i=o[b],j=i.isMultiMatch(g),j&&(d.push(new i(j,a)),c=!0);if(c)continue;for(b=-1;++b<x;)if(f=o[b],k=f.isSingleMatch(g),k){d.push(new f(k,a));break}}return d})}$=new Set([G.type,B.type]),Y=function(){function d(m){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=c.isCaseSensitive,g=f===void 0?a.isCaseSensitive:f,h=c.includeMatches,t=h===void 0?a.includeMatches:h,j=c.minMatchCharLength,r=j===void 0?a.minMatchCharLength:j,l=c.ignoreLocation,o=l===void 0?a.ignoreLocation:l,n=c.findAllMatches,p=n===void 0?a.findAllMatches:n,e=c.location,q=e===void 0?a.location:e,k=c.threshold,s=k===void 0?a.threshold:k,i=c.distance,u=i===void 0?a.distance:i;b(this,d),this.query=null,this.options={isCaseSensitive:g,includeMatches:t,minMatchCharLength:r,findAllMatches:p,ignoreLocation:o,location:q,threshold:s,distance:u},this.pattern=g?m:m.toLowerCase(),this.query=ax(this.pattern,this.options)}return c(d,[{key:"searchIn",value:function(c){var d=this.query,n,j,s,b,a,g,f,p,m,e,q,o,h,r,i,t,u,l;if(!d)return{isMatch:!1,score:1};n=this.options,j=n.includeMatches,s=n.isCaseSensitive,c=s?c:c.toLowerCase(),b=0,a=[],g=0;for(f=0,p=d.length;f<p;f+=1){m=d[f],a.length=0,b=0;for(e=0,q=m.length;e<q;e+=1)if(o=m[e],h=o.search(c),r=h.isMatch,i=h.indices,t=h.score,r)b+=1,g+=t,j&&(u=o.constructor.type,$.has(u)?a=[].concat(k(a),k(i)):a.push(i));else{g=0,b=0,a.length=0;break}if(b)return l={isMatch:!0,score:g/b},j&&(l.indices=a),l}return{isMatch:!1,score:1}}}],[{key:"condition",value:function(c,a){return a.useExtendedSearch}}]),d}(),n=[];function aM(){n.push.apply(n,arguments)}function A(a,b){for(var c=0,e=n.length,d;c<e;c+=1)if(d=n[c],d.condition(a,b))return new d(a,b);return new C(a,b)}m={AND:'$and',OR:'$or'},s={PATH:'$path',PATTERN:'$val'},t=function(a){return!!(a[m.AND]||a[m.OR])},ad=function(a){return!!a[s.PATH]},ae=function(a){return!g(a)&&W(a)&&!t(a)},y=function(a){return D({},m.AND,Object.keys(a).map(function(b){return D({},b,a[b])}))};function af(a,c){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},b=d.auto,e=b===void 0||b,h=function j(a){var b=Object.keys(a),d=ad(a),h,i,k,l;if(!d&&b.length>1&&!t(a))return j(y(a));if(ae(a)){if(h=d?a[s.PATH]:b[0],i=d?a[s.PATTERN]:a[h],!f(i))throw new Error(Q(h));return k={keyId:v(h),pattern:i},e&&(k.searcher=A(i,c)),k}return l={children:[],operator:b[0]},b.forEach(function(c){var b=a[c];g(b)&&b.forEach(function(a){l.children.push(j(a))})}),l};return t(a)||(a=y(a)),h(a)}l=function(){function e(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=arguments.length>2?arguments[2]:void 0;if(b(this,e),this.options=ag({},a,{},d),this.options.useExtendedSearch&&!!0)throw new Error(I);this._keyStore=new N(this.options.keys),this.setCollection(c,f)}return c(e,[{key:"setCollection",value:function(b,a){if(this._docs=b,a&&!(a instanceof q))throw new Error(H);this._myIndex=a||_(this.options.keys,this._docs,{getFn:this.options.getFn})}},{key:"add",value:function(a){if(!d(a))return;this._docs.push(a),this._myIndex.add(a)}},{key:"remove",value:function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){return!1},b=[],a=0,c=this._docs.length,d;a<c;a+=1)d=this._docs[a],e(d,a)&&(this.removeAt(a),a-=1,c-=1,b.push(d));return b}},{key:"removeAt",value:function(a){this._docs.splice(a,1),this._myIndex.removeAt(a)}},{key:"getIndex",value:function(){return this._myIndex}},{key:"search",value:function(c){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=h.limit,d=e===void 0?-1:e,a=this.options,g=a.includeMatches,i=a.includeScore,j=a.shouldSort,k=a.sortFn,l=a.ignoreFieldNorm,b=f(c)?f(this._docs[0])?this._searchStringList(c):this._searchObjectList(c):this._searchLogical(c);return aL(b,{ignoreFieldNorm:l}),j&&b.sort(k),Z(d)&&d>-1&&(b=b.slice(0,d)),aq(b,this._docs,{includeMatches:g,includeScore:i})}},{key:"_searchStringList",value:function(b){var c=A(b,this.options),e=this._myIndex.records,a=[];return e.forEach(function(e){var b=e.v,g=e.i,h=e.n,f,i,j,k;if(!d(b))return;f=c.searchIn(b),i=f.isMatch,j=f.score,k=f.indices,i&&a.push({item:b,idx:g,matches:[{score:j,value:b,norm:h,indices:k}]})}),a}},{key:"_searchLogical",value:function(h){var b=this,e=af(h,this.options),f=function t(a,d,l){var i,q,c,g,h,p,o,j,e,f,r,s,n;if(!a.children)return i=a.keyId,q=a.searcher,c=b._findMatches({key:b._keyStore.get(i),value:b._myIndex.getValueForItemAtKeyId(d,i),searcher:q}),c&&c.length?[{idx:l,item:d,matches:c}]:[];switch(a.operator){case m.AND:{g=[];for(h=0,p=a.children.length;h<p;h+=1)if(o=a.children[h],j=t(o,d,l),j.length)g.push.apply(g,k(j));else return[];return g}case m.OR:{e=[];for(f=0,r=a.children.length;f<r;f+=1)if(s=a.children[f],n=t(s,d,l),n.length){e.push.apply(e,k(n));break}return e}}},g=this._myIndex.records,a={},c=[];return g.forEach(function(h){var g=h.$,b=h.i,i;d(g)&&(i=f(e,g,b),i.length&&(a[b]||(a[b]={idx:b,item:g,matches:[]},c.push(a[b])),i.forEach(function(d){var e=d.matches,c;(c=a[b].matches).push.apply(c,k(e))})))}),c}},{key:"_searchObjectList",value:function(h){var e=this,f=A(h,this.options),b=this._myIndex,g=b.keys,c=b.records,a=[];return c.forEach(function(h){var c=h.$,i=h.i,b;if(!d(c))return;b=[],g.forEach(function(a,d){b.push.apply(b,k(e._findMatches({key:a,value:c[d],searcher:f})))}),b.length&&a.push({idx:i,item:c,matches:b})}),a}},{key:"_findMatches",value:function(b){var i=b.key,a=b.value,h=b.searcher,e,f,j,c,k,l,m;return d(a)?(e=[],g(a)?a.forEach(function(a){var b=a.v,f=a.i,g=a.n,c,j,k,l;if(!d(b))return;c=h.searchIn(b),j=c.isMatch,k=c.score,l=c.indices,j&&e.push({score:k,key:i,value:b,idx:f,norm:g,indices:l})}):(f=a.v,j=a.n,c=h.searchIn(f),k=c.isMatch,l=c.score,m=c.indices,k&&e.push({score:l,key:i,value:f,norm:j,indices:m})),e):[]}}]),e}();function aL(c,d){var b=d.ignoreFieldNorm,e=b===void 0?a.ignoreFieldNorm:b;c.forEach(function(a){var b=1;a.matches.forEach(function(a){var c=a.key,g=a.norm,d=a.score,f=c?c.weight:null;b*=Math.pow(d===0&&f?Number.EPSILON:d,(f||1)*(e?1:g))}),a.score=b})}function aq(f,i){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d=c.includeMatches,g=d===void 0?a.includeMatches:d,e=c.includeScore,h=e===void 0?a.includeScore:e,b=[];return g&&b.push(aw),h&&b.push(av),f.map(function(a){var c=a.idx,d={item:i[c],refIndex:c};return b.length&&b.forEach(function(b){b(a,d)}),d})}return l.version='6.4.3',l.createIndex=_,l.parseIndex=ay,l.config=a,l.parseQuery=af,aM(Y),l})